---
import Layout from "../layouts/Layout.astro";
import Hero from "../components/Hero.astro";
import About from "../components/About.astro";
import Skills from "../components/Skills.astro";
import Projects from "../components/Projects.astro";

---

<Layout
	title='Zeiko - Full Stack Developer'
	description='Full-stack developer specializing in React, Node.js, and modern web technologies. Building winning applications with a poker-inspired approach to development.'
>
	<Hero />
	<About />
	<Skills />
	<Projects />
</Layout>

<script>
	// Smooth scroll behavior for navigation
	document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
		anchor.addEventListener("click", function (e: Event) {
			e.preventDefault();
			const target = document.querySelector(
				(this as HTMLAnchorElement).getAttribute("href") || "",
			);
			if (target) {
				target.scrollIntoView({
					behavior: "smooth",
					block: "start",
				});
			}
		});
	});

	// Intersection Observer for animations
	const observerOptions = {
		root: null,
		rootMargin: "0px",
		threshold: 0.1,
	};

	const observer = new IntersectionObserver((entries) => {
		entries.forEach((entry) => {
			if (entry.isIntersecting) {
				entry.target.classList.add("animate-fade-in");
				observer.unobserve(entry.target);
			}
		});
	}, observerOptions);

	// Observe all sections
	document.querySelectorAll("section").forEach((section) => {
		observer.observe(section);
	});

	// Only one main section visible at a time
	const mainSections = ["about", "skills", "projects", "contact"];
	function updateSectionVisibility() {
		let found = false;
		mainSections.forEach((id) => {
			const el = document.getElementById(id);
			if (!el) return;
			const rect = el.getBoundingClientRect();
			const inView =
				rect.top < window.innerHeight / 2 &&
				rect.bottom > window.innerHeight / 2;
			if (inView && !found) {
				el.classList.add("visible-section");
				el.classList.remove("exclusive-section");
				found = true;
			} else {
				el.classList.remove("visible-section");
				el.classList.add("exclusive-section");
			}
		});
	}
	window.addEventListener("scroll", updateSectionVisibility);
	window.addEventListener("resize", updateSectionVisibility);
	window.addEventListener("DOMContentLoaded", updateSectionVisibility);
</script>

<style is:global>
	@keyframes fade-in {
		from {
			opacity: 0;
			transform: translateY(20px);
		}
		to {
			opacity: 1;
			transform: translateY(0);
		}
	}

	.animate-fade-in {
		animation: fade-in 0.6s ease-out forwards;
	}

	section {
		opacity: 0;
	}

	.exclusive-section {
		opacity: 0;
		pointer-events: none;
		transition: opacity 0.5s;
	}
	.exclusive-section.visible-section {
		opacity: 1;
		pointer-events: auto;
		z-index: 10;
	}
</style>
